# Claude Code Hook Notifier

A modern TypeScript CLI tool that sets up native desktop notifications for Claude Code task events. Features a robust modular architecture with enhanced security, comprehensive error handling, and cross-platform support.

[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?style=flat-square&logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![Node.js](https://img.shields.io/badge/Node.js-43853D?style=flat-square&logo=node.js&logoColor=white)](https://nodejs.org/)
[![MIT License](https://img.shields.io/badge/License-MIT-yellow.svg?style=flat-square)](LICENSE)

## 🚀 Quick Start

### Installation & Usage

```bash
# Install dependencies
npm install

# Build the TypeScript project
npm run build

# Run the interactive CLI
npm start
```

### Development Mode

```bash
# Watch mode with auto-recompilation
npm run dev

# Type checking only
npm run typecheck
```

This opens an interactive setup process to configure your notification hooks with full type safety.

## ✨ Features

- **🔷 TypeScript First:** Full type safety with strict TypeScript configuration
- **🖥️ Cross-Platform:** Native notifications on macOS and Windows
- **🛡️ Enhanced Security:** Input sanitization and safe command generation
- **🏗️ Modern Architecture:** Clean, modular codebase with enum structures
- **🔄 Error Recovery:** Comprehensive error handling with user-friendly messages
- **🎛️ Interactive CLI:** Intuitive setup process with confirmation prompts
- **📦 Modern Build System:** TypeScript compilation with watch mode support

## How it Works

The tool detects your operating system and generates secure notification commands that are added to your Claude Code `settings.json` file.

### Platform Support

- **macOS:** Uses `osascript` to display native notifications with optional sound
- **Windows:** Uses PowerShell with `System.Windows.Forms.NotifyIcon` for balloon tip notifications

### Configuration File Location

- **Windows:** `%USERPROFILE%\.claude\settings.json`
- **macOS/Linux:** `~/.claude/settings.json`

## 🏗️ Architecture

Modern TypeScript architecture with enhanced type safety:

```
├── index.ts                 # Main TypeScript entry point
├── dist/                    # Compiled JavaScript output
├── src/
│   ├── types/              # Central type definitions & enums
│   ├── platforms/          # Platform implementations (.ts)
│   ├── config/             # Settings management
│   ├── cli/                # CLI components
│   └── utils/              # Error handling & utilities
└── docs/                   # Documentation
```

### Key TypeScript Features

- **🔷 Strict Type Safety:** Full TypeScript with strict mode enabled
- **📋 Enum Structures:** Type-safe actions, platforms, and error codes
- **🏭 Abstract Classes:** Clean inheritance with proper override decorators
- **🛡️ Type Guards:** Runtime type validation with compile-time safety
- **📦 Modern Build:** ES2022 target with ESNext modules

## Security Features

- **Input Sanitization:** All user inputs are sanitized before use in commands
- **Safe Command Generation:** Commands are generated using known safe patterns
- **Platform-Specific Security:** Each platform implements appropriate sanitization
- **No Code Injection:** Commands are generated by our code, not user input

## 🛠️ Development

### Build Commands

| Command | Description |
|---------|-------------|
| `npm run build` | Compile TypeScript to JavaScript |
| `npm run dev` | Watch mode - recompile on changes |
| `npm run typecheck` | Type checking without compilation |
| `npm run clean` | Remove dist/ folder |
| `npm start` | Run the compiled application |

### TypeScript Setup

The project uses strict TypeScript configuration:
- **Target:** ES2022 with ESNext modules
- **Strict Mode:** All strict checks enabled
- **Declaration Maps:** Full source map support
- **Module Resolution:** Node16 for modern imports

See [`docs/TYPESCRIPT_MIGRATION.md`](./docs/TYPESCRIPT_MIGRATION.md) for migration details.

### Adding New Platforms

Extend the type-safe platform system:

```typescript
// src/platforms/linux.ts
import { NotificationPlatform } from './base.js';
import { Platform } from '../types/index.js';

export class LinuxPlatform extends NotificationPlatform {
    override isSupported(): boolean {
        return process.platform === 'linux';
    }

    override getPlatformId(): Platform {
        return Platform.LINUX;
    }

    override createCommand(action: HookAction, withSound: boolean): string {
        // Implementation for Linux notifications
    }
}
```

## Contributing

This project follows clean architecture principles. When contributing:

- Maintain separation of concerns
- Add appropriate error handling and input sanitization
- Follow security best practices
- Update tests and documentation
